### Backend flags ###
# The following `dev run` commands are sufficient to run the full backend of this
# app locally.

# Watch if any generated or source files are modified.
dev run --watch=backend/api/**/*.py
dev run --watch=backend/src/**/*.py

# Find the protos in the `api/` directory.
protoc api/

# Put boilerplate files in 'boilerplate/'.
protoc --boilerplate=boilerplate/

# Generate code for a Python backend and React frontend.
protoc --generate=python,react

# Generate proto code into different directories for different languages.
protoc --
protoc --python_out=backend/api/
protoc --resemble_react_out=web/src/gen

# Don't cause chaos; it makes it hard to play with the API with e.g. `grpcurl`
# if that API is constantly going down and coming back up.
dev run --no-chaos

dev run --secrets-directory=./backend/secrets

# PYTHONPATH must be explicitly set to pick up generated code.
dev run --env=PYTHONPATH=backend/api/

dev run --python
dev run backend/src/main.py
